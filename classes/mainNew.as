package classes {		import flash.display.Sprite;	import flash.display.MovieClip;	 	import flash.events.*;	import flash.utils.*;	import flash.ui.Keyboard;	import flash.events.MouseEvent; 		import flash.net.URLRequest;	import flash.display.Loader;	import flash.display.LoaderInfo;	import flash.net.URLLoader;	import flash.events.IOErrorEvent;	import flash.system.fscommand;  	import flash.ui.Mouse; 	  		import flash.system.ImageDecodingPolicy;	import flash.geom.ColorTransform;		//import com.adobe.images.JPGEncoder;	//import com.adobe.images.BMPEncoder;	public class main extends MovieClip {		 		// ----------------------------------		// -- variables 		// ----------------------------------		private var _loader:URLLoader = new URLLoader();		private var _request:URLRequest;		private var _imageloader:Loader = new Loader();         		private var pLoader:URLLoader; 			// pour init		private var pXML:XML; 			private var pXMLtweets:XML; 			        private var pTabId:Array;          					private var pTempo:Number;		private var pDelai:Number;		private var pDelaiRotation:Number;						public var pServeur:String;	    public var mysocket:CustomSocket;	    public var myDelai:Number;	    public var myTimer:Number;	    public var pOldReponse:String="";				public var pPage:String;				// ----------------------------------		// -- constructeur 		// ----------------------------------		public function main() {						//-- variables locales -------------------------			var vXML_URL:String;        	var vXML_URLRequest:URLRequest;						pTempo = getTimer();					        // -- init ----			pServeur="127.0.0.1";	        myDelai = 2000;	        myTimer = getTimer();	        pOldReponse = "";	                    mysocket = new CustomSocket(pServeur,  6100); // Number(pXML.SOCKETPORT)	            			this.addEventListener( Event.ENTER_FRAME, EnterHandler );			this.addChild(_imageloader);			setChildIndex(controle,numChildren-1);		}		private function Charge():void 		{ 			var vTimer:Number = getTimer();			trace(pPage);//"http://albertinemeunier.net/infini/getPage.php?id=x8EEAQAAIAAJ&p="+pPage+"&astuce="+vTimer);			_request = new URLRequest("http://albertinemeunier.net/infini/getPage.php?id=x8EEAQAAIAAJ&p="+pPage+"&astuce="+vTimer);			_imageloader.load(_request);					}				//-------------------------------------------		// enterframe ----------------------		//-------------------------------------------		private function EnterHandler(MonEvent:Event):void		{							var vTimer:Number;			var vTexte:String;			var vTabTexte:Array;						//-------------------			vTimer = getTimer();				//-- --------------			// socket			//-------------------				if (mysocket.connectOK==false){										if (vTimer-myTimer>myDelai){						myTimer = vTimer;						mysocket.reconnect();												//if (pTest==1){							controle.text="tentative : "+vTimer+" millisecondes";						//}else{						//}											}else{					}				}else{					if (mysocket.response==""){											}else{						controle.text=mysocket.response;						pOldReponse=mysocket.response;						vTexte=controle.text;						vTexte = vTexte.substr(1,vTexte.length);						vTabTexte = vTexte.split("r");						trace(vTabTexte[0]+"/"+vTabTexte[1]);						if (vTabTexte[0]==pPage){							_imageloader.rotation=Number(vTabTexte[1]);						}else{							pPage=vTabTexte[0];							Charge();													}						//pPage						// recherche des infos						//Charge();						mysocket.response="";					}				}										}			}}